---
title: "assignment_1_2023900021"
output: html_document
date: "2026-01-31"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

---

## QUESTION 1 — Population is Normal (N(100, 15))

### What you’re simulating

* Population mean (\mu = 100)
* Population SD (\sigma = 15)
* For each sample size (n \in {10, 50, 100, 500, 1500}):

  * repeat 1000 trials:

    * draw (n) values
    * compute sample mean (\bar{x})
    * compute sample SD (s)
  * plot histogram of all 1000 means, and all 1000 SDs

### R code (Q1)

```{r}
set.seed(7)

mu <- 100
sigma <- 15
trials <- 1000
ns <- c(10, 50, 100, 500, 1500)

simulate_means_sds <- function(n, trials, mu, sigma) {
  means <- numeric(trials)
  sds   <- numeric(trials)

  for (t in 1:trials) {
    x <- rnorm(n, mean = mu, sd = sigma)
    means[t] <- mean(x)
    sds[t]   <- sd(x)   # R uses (n-1) in denominator by default
  }
  list(means = means, sds = sds)
}

par(mfrow = c(length(ns), 2), mar = c(3.5, 3.5, 2, 1))

for (n in ns) {
  out <- simulate_means_sds(n, trials, mu, sigma)

  hist(out$means, breaks = 30, main = paste("Means (n =", n, ")"),
       xlab = "sample mean", col = "gray")
  abline(v = mu, lwd = 2)  # true mean

  hist(out$sds, breaks = 30, main = paste("SDs (n =", n, ")"),
       xlab = "sample SD", col = "gray")
  abline(v = sigma, lwd = 2)  # true SD
}
```

### What to write for (e): Observations + CLT

Use these points (short, clear, correct):

1. **Histogram of sample means**

* As (n) increases, the distribution of (\bar{x}) becomes **tighter around 100**.
* The “spread” of the means shrinks roughly like the **standard error**:
  [
  SE(\bar{x}) = \frac{\sigma}{\sqrt{n}} = \frac{15}{\sqrt{n}}
  ]
* Because the population is already normal, the sampling distribution of the mean is normal even for small-ish (n), but it still becomes much narrower as (n) grows.  

2. **Histogram of sample SDs**

* For small (n), sample SD values vary a lot (wide histogram).
* As (n) increases, the sample SDs **concentrate near 15** (more stable estimate).
* You may notice slight asymmetry/right-skew for small (n) (SD can’t be negative).

3. **Inference**

* Bigger (n) → sample mean is a **more accurate “best guess”** of population mean 100, because the sampling distribution gets narrower (less randomness). 

---

## QUESTION 2 — Population is Beta(2, 5)

### Key population facts (you can mention in write-up)

For (X \sim \text{Beta}(a=2,b=5)):

* Population mean:
  [
  \mu = \frac{a}{a+b} = \frac{2}{7} \approx 0.2857
  ]
* It’s **right-skewed** (not symmetric), so CLT needs a bit more (n) for the sample mean histogram to look very normal. 

### R code (Q2)

```{r}
set.seed(7)

a <- 2
b <- 5
trials <- 1000
ns <- c(10, 50, 100, 500, 1500)

beta_mean <- a / (a + b)

simulate_beta <- function(n, trials, a, b) {
  means <- numeric(trials)
  sds   <- numeric(trials)

  for (t in 1:trials) {
    x <- rbeta(n, shape1 = a, shape2 = b)
    means[t] <- mean(x)
    sds[t]   <- sd(x)
  }
  list(means = means, sds = sds)
}

par(mfrow = c(length(ns), 2), mar = c(3.5, 3.5, 2, 1))

for (n in ns) {
  out <- simulate_beta(n, trials, a, b)

  hist(out$means, breaks = 30, main = paste("Means (n =", n, ")"),
       xlab = "sample mean", col = "gray")
  abline(v = beta_mean, lwd = 2)

  hist(out$sds, breaks = 30, main = paste("SDs (n =", n, ")"),
       xlab = "sample SD", col = "gray")
}
```

### What’s different vs Q1 (write this for Q2 explanation)

1. **For small n (like 10)**, the histogram of sample means is **less bell-shaped** (can look skewed / not perfectly normal), because the population is skewed.
2. As (n) increases (50 → 100 → 500), the sample mean histogram becomes **more normal-looking** and tight around (\approx 0.2857). That’s CLT in action. 
3. **Do you need larger or smaller n now?**

* **Larger n** (compared to the normal population case) to get a clean, normal-looking sampling distribution of the mean and a stable estimate, because skewed populations typically require bigger sample sizes for CLT to “kick in” visually. 

---

## OPTIONAL QUESTION 3 — CIs and sample size (n=30, 70, 100)

You sample from:

1. (N(0,1))
2. (N(2,0.5))
3. (N(3,2))

Then for each group you compute mean + 95% CI:
[
\bar{x} \pm t_{0.975,,n-1}\cdot \frac{s}{\sqrt{n}}
]
Use **t** because population SD is “unknown” in practice. 

### R code (Q3)

```{r}
set.seed(7)

make_group <- function(n, mu, sd, label) {
  x <- rnorm(n, mean = mu, sd = sd)
  xbar <- mean(x)
  s <- sd(x)
  tcrit <- qt(0.975, df = n - 1)
  se <- s / sqrt(n)
  ci_low <- xbar - tcrit * se
  ci_high <- xbar + tcrit * se

  data.frame(
    group = label,
    n = n,
    mean = xbar,
    sd = s,
    ci_low = ci_low,
    ci_high = ci_high
  )
}

run_q3_for_n <- function(n) {
  rbind(
    make_group(n, 0, 1,   "N(0,1)"),
    make_group(n, 2, 0.5, "N(2,0.5)"),
    make_group(n, 3, 2,   "N(3,2)")
  )
}

res30 <- run_q3_for_n(30)
res70 <- run_q3_for_n(70)
res100 <- run_q3_for_n(100)

res <- rbind(res30, res70, res100)
print(res)

# Plot means with CI error bars (base R)
par(mfrow = c(1,3), mar = c(5,4,2,1))
plot_ci <- function(df, title) {
  y <- df$mean
  x <- 1:nrow(df)
  plot(x, y, xaxt="n", xlab="", ylab="mean", main=title, pch=16,
       ylim = range(df$ci_low, df$ci_high))
  axis(1, at=x, labels=df$group, las=2)
  segments(x0=x, y0=df$ci_low, x1=x, y1=df$ci_high, lwd=2)
}

plot_ci(res30, "n = 30 (95% CI)")
plot_ci(res70, "n = 70 (95% CI)")
plot_ci(res100,"n = 100 (95% CI)")
```

### What to write for (d) and (e)

* As (n) increases from 30 → 70 → 100, the CI width **shrinks**, because:
  [
  SE = \frac{s}{\sqrt{n}}
  ]
  so bigger (n) → smaller SE → narrower CI. 
* The group with **largest SD (N(3,2))** will have the **widest CI** at every (n), because more variability → larger SE → wider CI.
* Interpretation (frequentist): if you repeat the whole sampling process many times, **95% of such intervals will contain the true mean**. 

---

