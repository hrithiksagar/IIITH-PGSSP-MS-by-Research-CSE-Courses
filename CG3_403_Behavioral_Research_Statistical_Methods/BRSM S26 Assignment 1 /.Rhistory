set.seed(7)
mu <- 100
sigma <- 15
trials <- 1000
ns <- c(10, 50, 100, 500, 1500)
simulate_means_sds <- function(n, trials, mu, sigma) {
means <- numeric(trials)
sds   <- numeric(trials)
for (t in 1:trials) {
x <- rnorm(n, mean = mu, sd = sigma)
means[t] <- mean(x)
sds[t]   <- sd(x)   # R uses (n-1) in denominator by default
}
list(means = means, sds = sds)
}
par(mfrow = c(length(ns), 2), mar = c(3.5, 3.5, 2, 1))
for (n in ns) {
out <- simulate_means_sds(n, trials, mu, sigma)
hist(out$means, breaks = 30, main = paste("Means (n =", n, ")"),
xlab = "sample mean", col = "gray")
abline(v = mu, lwd = 2)  # true mean
hist(out$sds, breaks = 30, main = paste("SDs (n =", n, ")"),
xlab = "sample SD", col = "gray")
abline(v = sigma, lwd = 2)  # true SD
}
knitr::opts_chunk$set(echo = TRUE)
set.seed(7)
mu <- 100
sigma <- 15
trials <- 1000
ns <- c(10, 50, 100, 500, 1500)
simulate_means_sds <- function(n, trials, mu, sigma) {
means <- numeric(trials)
sds   <- numeric(trials)
for (t in 1:trials) {
x <- rnorm(n, mean = mu, sd = sigma)
means[t] <- mean(x)
sds[t]   <- sd(x)   # R uses (n-1) in denominator by default
}
list(means = means, sds = sds)
}
par(mfrow = c(length(ns), 2), mar = c(3.5, 3.5, 2, 1))
for (n in ns) {
out <- simulate_means_sds(n, trials, mu, sigma)
hist(out$means, breaks = 30, main = paste("Means (n =", n, ")"),
xlab = "sample mean", col = "gray")
abline(v = mu, lwd = 2)  # true mean
hist(out$sds, breaks = 30, main = paste("SDs (n =", n, ")"),
xlab = "sample SD", col = "gray")
abline(v = sigma, lwd = 2)  # true SD
}
set.seed(7)
a <- 2
b <- 5
trials <- 1000
ns <- c(10, 50, 100, 500, 1500)
beta_mean <- a / (a + b)
simulate_beta <- function(n, trials, a, b) {
means <- numeric(trials)
sds   <- numeric(trials)
for (t in 1:trials) {
x <- rbeta(n, shape1 = a, shape2 = b)
means[t] <- mean(x)
sds[t]   <- sd(x)
}
list(means = means, sds = sds)
}
par(mfrow = c(length(ns), 2), mar = c(3.5, 3.5, 2, 1))
for (n in ns) {
out <- simulate_beta(n, trials, a, b)
hist(out$means, breaks = 30, main = paste("Means (n =", n, ")"),
xlab = "sample mean", col = "gray")
abline(v = beta_mean, lwd = 2)
hist(out$sds, breaks = 30, main = paste("SDs (n =", n, ")"),
xlab = "sample SD", col = "gray")
}
set.seed(7)
make_group <- function(n, mu, sd, label) {
x <- rnorm(n, mean = mu, sd = sd)
xbar <- mean(x)
s <- sd(x)
tcrit <- qt(0.975, df = n - 1)
se <- s / sqrt(n)
ci_low <- xbar - tcrit * se
ci_high <- xbar + tcrit * se
data.frame(
group = label,
n = n,
mean = xbar,
sd = s,
ci_low = ci_low,
ci_high = ci_high
)
}
run_q3_for_n <- function(n) {
rbind(
make_group(n, 0, 1,   "N(0,1)"),
make_group(n, 2, 0.5, "N(2,0.5)"),
make_group(n, 3, 2,   "N(3,2)")
)
}
res30 <- run_q3_for_n(30)
res70 <- run_q3_for_n(70)
res100 <- run_q3_for_n(100)
res <- rbind(res30, res70, res100)
print(res)
# Plot means with CI error bars (base R)
par(mfrow = c(1,3), mar = c(5,4,2,1))
plot_ci <- function(df, title) {
y <- df$mean
x <- 1:nrow(df)
plot(x, y, xaxt="n", xlab="", ylab="mean", main=title, pch=16,
ylim = range(df$ci_low, df$ci_high))
axis(1, at=x, labels=df$group, las=2)
segments(x0=x, y0=df$ci_low, x1=x, y1=df$ci_high, lwd=2)
}
plot_ci(res30, "n = 30 (95% CI)")
plot_ci(res70, "n = 70 (95% CI)")
plot_ci(res100,"n = 100 (95% CI)")
