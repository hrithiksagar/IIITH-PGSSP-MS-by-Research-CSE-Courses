data <- as.data.frame(read_excel(xlsx_path, sheet = "Statistical Deception"))
data <- data[, sapply(data, is.numeric), drop = FALSE]
data_long <- pivot_longer(data, cols = everything(), names_to = "Group", values_to = "Value")
# 1) Bar plot of means
means <- colMeans(data, na.rm = TRUE)
barplot(means, col="lightblue", main="Bar Plot of Means (Misleading)", ylab="Mean", xlab="Group")
knitr::opts_chunk$set(echo = TRUE)
# install.packages(c("readxl","tidyr","ggplot2","dplyr","ggridges","ggdist","waffle","fmsb","reshape2"))
library(readxl)
library(tidyr)
library(ggplot2)
library(dplyr)
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
data <- as.data.frame(read_excel(xlsx_path, sheet = "Statistical Deception"))
data <- data[, sapply(data, is.numeric), drop = FALSE]
data_long <- pivot_longer(data, cols = everything(), names_to = "Group", values_to = "Value")
# 1) Bar plot of means
means <- colMeans(data, na.rm = TRUE)
barplot(means, col="lightblue", main="Bar Plot of Means (Misleading)", ylab="Mean", xlab="Group")
# 2) Boxplot
ggplot(data_long, aes(Group, Value)) + geom_boxplot() +
labs(title="Boxplot", x="Group", y="Value") + theme_minimal()
# 3) Jitter + boxplot
ggplot(data_long, aes(Group, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width=0.15, alpha=0.7, size=2) +
labs(title="Jitter + Boxplot", x="Group", y="Value") + theme_minimal()
# 4) Histogram (facets)
ggplot(data_long, aes(Value)) +
geom_histogram(bins=15) +
facet_wrap(~Group, scales="free_y") +
labs(title="Histograms by Group", x="Value", y="Count") + theme_minimal()
# 5) Density (facets)
ggplot(data_long, aes(Value)) +
geom_density() +
facet_wrap(~Group, scales="free_y") +
labs(title="Density by Group", x="Value", y="Density") + theme_minimal()
# 6) Line plot (index vs value)
data_long <- data_long %>% group_by(Group) %>% mutate(Index = row_number()) %>% ungroup()
ggplot(data_long, aes(Index, Value, color=Group)) +
geom_line(alpha=0.7) +
facet_wrap(~Group, scales="free_y") +
labs(title="Line Plot (Index vs Value)", x="Row index", y="Value") + theme_minimal()
# 7) Raincloud / raindrop (needs ggdist)
if (!requireNamespace("ggdist", quietly = TRUE)) {
message("Skipping Raincloud: install.packages('ggdist')")
} else {
library(ggdist)
ggplot(data_long, aes(x=Group, y=Value)) +
ggdist::stat_halfeye(adjust=0.6, width=0.6, justification=-0.2, .width=0) +
geom_boxplot(width=0.15, outlier.shape=NA) +
geom_jitter(width=0.12, alpha=0.5, size=1.6) +
coord_flip() +
labs(title="Raincloud (Half-eye + Box + Points)", x="Group", y="Value") +
theme_minimal()
}
# 8) Mosaic plot (needs categorical data; bin values)
data_long$Bin <- cut(data_long$Value, breaks=5)
tab <- table(data_long$Group, data_long$Bin)
mosaicplot(tab, main="Mosaic Plot (Group x Binned Value)", xlab="Group", ylab="Value bins")
# 9) Waffle plot (counts per group; needs waffle)
counts <- table(data_long$Group)
if (!requireNamespace("waffle", quietly = TRUE)) {
message("Skipping Waffle: install.packages('waffle')")
} else {
waffle::waffle(as.list(counts), rows=5, title="Waffle Plot (Counts per Group)")
}
# 10) Pie chart (counts per group)
pie(counts, main="Pie Chart (Counts per Group)")
# 11) Radar chart (mean + sd per group; needs fmsb)
stats <- data_long %>% group_by(Group) %>% summarise(mean=mean(Value), sd=sd(Value), .groups="drop")
rad <- as.data.frame(t(stats[,c("mean","sd")]))
colnames(rad) <- stats$Group
rad <- rbind(apply(rad,1,max), apply(rad,1,min), rad)
if (!requireNamespace("fmsb", quietly = TRUE)) {
message("Skipping Radar: install.packages('fmsb')")
} else {
library(fmsb)
fmsb::radarchart(rad, axistype=1, title="Radar Chart (Mean & SD)")
}
# 12) Heatmap (correlation across x1-x4)
cor_mat <- cor(data, use="complete.obs")
if (!requireNamespace("reshape2", quietly = TRUE)) {
message("Skipping ggplot heatmap: install.packages('reshape2')")
heatmap(cor_mat, main="Heatmap: Correlation (base R)")
} else {
library(reshape2)
cor_long <- reshape2::melt(cor_mat)
ggplot(cor_long, aes(Var1, Var2, fill=value)) +
geom_tile() +
labs(title="Heatmap: Correlation", x="", y="", fill="corr") +
theme_minimal()
}
knitr::opts_chunk$set(echo = TRUE)
```{r}
# install.packages(c("readxl","tidyr","ggplot2","dplyr"))
library(readxl)
library(tidyr)
library(ggplot2)
library(dplyr)
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
# ---- Load Sheet 2 ----
df <- read_excel(xlsx_path, sheet = "Movement Personality Results")
df <- as.data.frame(df)
# Keep only numeric columns (importance values)
num_cols <- names(df)[sapply(df, is.numeric)]
df_num <- df[, num_cols, drop = FALSE]
# Long format: Joint x Trait -> Importance
# If your sheet already has columns like: Joint, Trait, Importance, then skip this and use them directly.
long <- pivot_longer(
df_num,
cols = everything(),
names_to = "Trait",
values_to = "Importance"
)
# Add joint index (assumes each row corresponds to one joint: 12 rows)
# If you have an actual joint-name column in df (e.g., "Joint"), replace Joint = ... accordingly.
long <- long %>%
group_by(Trait) %>%
mutate(Joint = rep(paste0("J", seq_len(nrow(df_num))), times = 1)) %>%
ungroup()
# ---- 1) Heatmap (recommended) ----
p_heat <- ggplot(long, aes(x = Trait, y = Joint, fill = Importance)) +
geom_tile() +
labs(title = "Heatmap: Joint Importance per Personality Trait",
x = "Personality Trait", y = "Joint") +
theme_minimal(base_size = 13)
print(p_heat)
# ---- 2) Grouped bar plot (alternative) ----
p_bar <- ggplot(long, aes(x = Joint, y = Importance, fill = Trait)) +
geom_col(position = "dodge") +
labs(title = "Grouped Bar Plot: Joint Importance per Trait",
x = "Joint", y = "Importance") +
theme_minimal(base_size = 13)
print(p_bar)
knitr::opts_chunk$set(echo = TRUE)
# install.packages(c("tidyr","dplyr","ggplot2","readxl"))
library(tidyr)
library(dplyr)
library(ggplot2)
library(readxl)
# =========================
# Q3.1 The Last of Us (given counts)
# =========================
last_of_us <- tribble(
~Location,            ~Gender,  ~Outcome,   ~Count,
"Safe Zone",          "Male",   "Zombie",   118,
"Safe Zone",          "Male",   "Survived", 62,
"Safe Zone",          "Female", "Zombie",   4,
"Safe Zone",          "Female", "Survived", 141,
"Contaminated City",  "Male",   "Zombie",   154,
"Contaminated City",  "Male",   "Survived", 25,
"Contaminated City",  "Female", "Zombie",   13,
"Contaminated City",  "Female", "Survived", 93,
"Rural Area",         "Male",   "Zombie",   422,
"Rural Area",         "Male",   "Survived", 88,
"Rural Area",         "Female", "Zombie",   106,
"Rural Area",         "Female", "Survived", 90,
"Isolated Island",    "Male",   "Zombie",   670,
"Isolated Island",    "Male",   "Survived", 192,
"Isolated Island",    "Female", "Zombie",   3,
"Isolated Island",    "Female", "Survived", 20
)
# Add totals + survival rate
last_of_us2 <- last_of_us %>%
group_by(Location, Gender) %>%
mutate(Total = sum(Count)) %>%
ungroup() %>%
mutate(Prop = Count / Total)
# Plot A: Outcome proportions (best for "survival chances")
ggplot(last_of_us2, aes(x = Location, y = Prop, fill = Outcome)) +
geom_col(position = "fill") +
facet_wrap(~Gender) +
labs(title = "Outcome Proportions by Location (Faceted by Gender)",
x = "Location", y = "Proportion") +
theme_minimal(base_size = 13)
# Plot B: Raw counts (common outcomes, absolute burden)
ggplot(last_of_us, aes(x = Location, y = Count, fill = Outcome)) +
geom_col(position = "stack") +
facet_wrap(~Gender) +
labs(title = "Outcome Counts by Location (Faceted by Gender)",
x = "Location", y = "Count") +
theme_minimal(base_size = 13)
# =========================
# Q3.2 Glass Glimpse (Sheet 3): RI vs Glass Type
# =========================
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
glass <- read_excel(xlsx_path, sheet = "Glass Glimpse")
glass <- as.data.frame(glass)
# Make flexible column selection (handles slight name differences)
colnames(glass) <- trimws(colnames(glass))
type_col <- grep("^Type$|Glass.*Type|glass.*type", colnames(glass), ignore.case = TRUE, value = TRUE)[1]
ri_col   <- grep("^RI$|Refractive.*Index|refractive.*index", colnames(glass), ignore.case = TRUE, value = TRUE)[1]
glass2 <- glass %>%
select(Type = all_of(type_col), RI = all_of(ri_col)) %>%
mutate(Type = as.factor(Type), RI = as.numeric(RI)) %>%
filter(!is.na(Type), !is.na(RI))
# Plot A: Boxplot + jitter (distribution per type)
ggplot(glass2, aes(x = Type, y = RI)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = 0.15, alpha = 0.6, size = 1.8) +
labs(title = "RI by Glass Type (Boxplot + Points)",
x = "Glass Type", y = "Refractive Index (RI)") +
theme_minimal(base_size = 13)
# Plot B: Violin + points (shape, multimodality)
ggplot(glass2, aes(x = Type, y = RI)) +
geom_violin(trim = FALSE) +
geom_jitter(width = 0.15, alpha = 0.5, size = 1.6) +
labs(title = "RI by Glass Type (Violin + Points)",
x = "Glass Type", y = "Refractive Index (RI)") +
theme_minimal(base_size = 13)
# =========================
# Q3.3 Night at the Museum (Sheet 4): visitors over time
# =========================
museum <- read_excel(xlsx_path, sheet = "Museum Visitor")
museum <- as.data.frame(museum)
colnames(museum) <- trimws(colnames(museum))
# Attempt to detect likely columns
year_col <- grep("year|Year", colnames(museum), ignore.case = TRUE, value = TRUE)[1]
# If data is wide (one column per museum), pivot longer:
if (!is.na(year_col) && ncol(museum) > 2) {
museum_long <- museum %>%
rename(Year = all_of(year_col)) %>%
pivot_longer(cols = -Year, names_to = "Museum", values_to = "Visitors") %>%
mutate(Year = as.integer(Year),
Visitors = as.numeric(Visitors))
} else {
# If already long format, try to detect columns
mus_col <- grep("museum|Museum", colnames(museum), ignore.case = TRUE, value = TRUE)[1]
vis_col <- grep("visit|Visitors|Count", colnames(museum), ignore.case = TRUE, value = TRUE)[1]
museum_long <- museum %>%
select(Year = all_of(year_col), Museum = all_of(mus_col), Visitors = all_of(vis_col)) %>%
mutate(Year = as.integer(Year),
Museum = as.factor(Museum),
Visitors = as.numeric(Visitors))
}
# install.packages(c("tidyr","dplyr","ggplot2","readxl"))
library(tidyr)
library(dplyr)
library(ggplot2)
library(readxl)
# =========================
# Q3.1 The Last of Us (given counts)
# =========================
last_of_us <- tribble(
~Location,            ~Gender,  ~Outcome,   ~Count,
"Safe Zone",          "Male",   "Zombie",   118,
"Safe Zone",          "Male",   "Survived", 62,
"Safe Zone",          "Female", "Zombie",   4,
"Safe Zone",          "Female", "Survived", 141,
"Contaminated City",  "Male",   "Zombie",   154,
"Contaminated City",  "Male",   "Survived", 25,
"Contaminated City",  "Female", "Zombie",   13,
"Contaminated City",  "Female", "Survived", 93,
"Rural Area",         "Male",   "Zombie",   422,
"Rural Area",         "Male",   "Survived", 88,
"Rural Area",         "Female", "Zombie",   106,
"Rural Area",         "Female", "Survived", 90,
"Isolated Island",    "Male",   "Zombie",   670,
"Isolated Island",    "Male",   "Survived", 192,
"Isolated Island",    "Female", "Zombie",   3,
"Isolated Island",    "Female", "Survived", 20
)
# Add totals + survival rate
last_of_us2 <- last_of_us %>%
group_by(Location, Gender) %>%
mutate(Total = sum(Count)) %>%
ungroup() %>%
mutate(Prop = Count / Total)
# Plot A: Outcome proportions (best for "survival chances")
ggplot(last_of_us2, aes(x = Location, y = Prop, fill = Outcome)) +
geom_col(position = "fill") +
facet_wrap(~Gender) +
labs(title = "Outcome Proportions by Location (Faceted by Gender)",
x = "Location", y = "Proportion") +
theme_minimal(base_size = 13)
# Plot B: Raw counts (common outcomes, absolute burden)
ggplot(last_of_us, aes(x = Location, y = Count, fill = Outcome)) +
geom_col(position = "stack") +
facet_wrap(~Gender) +
labs(title = "Outcome Counts by Location (Faceted by Gender)",
x = "Location", y = "Count") +
theme_minimal(base_size = 13)
# =========================
# Q3.2 Glass Glimpse (Sheet 3): RI vs Glass Type
# =========================
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
glass <- read_excel(xlsx_path, sheet = "Glass Glimpse")
glass <- as.data.frame(glass)
# Make flexible column selection (handles slight name differences)
colnames(glass) <- trimws(colnames(glass))
type_col <- grep("^Type$|Glass.*Type|glass.*type", colnames(glass), ignore.case = TRUE, value = TRUE)[1]
ri_col   <- grep("^RI$|Refractive.*Index|refractive.*index", colnames(glass), ignore.case = TRUE, value = TRUE)[1]
glass2 <- glass %>%
select(Type = all_of(type_col), RI = all_of(ri_col)) %>%
mutate(Type = as.factor(Type), RI = as.numeric(RI)) %>%
filter(!is.na(Type), !is.na(RI))
# Plot A: Boxplot + jitter (distribution per type)
ggplot(glass2, aes(x = Type, y = RI)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = 0.15, alpha = 0.6, size = 1.8) +
labs(title = "RI by Glass Type (Boxplot + Points)",
x = "Glass Type", y = "Refractive Index (RI)") +
theme_minimal(base_size = 13)
# Plot B: Violin + points (shape, multimodality)
ggplot(glass2, aes(x = Type, y = RI)) +
geom_violin(trim = FALSE) +
geom_jitter(width = 0.15, alpha = 0.5, size = 1.6) +
labs(title = "RI by Glass Type (Violin + Points)",
x = "Glass Type", y = "Refractive Index (RI)") +
theme_minimal(base_size = 13)
# =========================
# Q3.3 Night at the Museum (Sheet 4): visitors over time
# =========================
museum <- read_excel(xlsx_path, sheet = "Museum Visitor")
museum <- as.data.frame(museum)
colnames(museum) <- trimws(colnames(museum))
print("Columns in Museum Visitor sheet:")
print(colnames(museum))
# ---- Case A: WIDE format ----
# Expected: first column is Year, remaining columns are museum names
if (any(grepl("year", colnames(museum), ignore.case = TRUE)) && ncol(museum) >= 3) {
year_col <- colnames(museum)[grepl("year", colnames(museum), ignore.case = TRUE)][1]
museum_long <- museum %>%
rename(Year = !!year_col) %>%
pivot_longer(cols = -Year, names_to = "Museum", values_to = "Visitors") %>%
mutate(
Year = as.integer(Year),
Visitors = as.numeric(Visitors),
Museum = as.factor(Museum)
) %>%
filter(!is.na(Year), !is.na(Visitors))
} else {
# ---- Case B: LONG format ----
# Try common names directly (edit here if your names differ)
# These are the most common possibilities:
possible_year <- c("Year", "year")
possible_mus  <- c("Museum", "museum", "Museum_Name", "museum_name")
possible_vis  <- c("Visitors", "visitors", "VisitorCount", "visitor_count", "Count", "count")
year_col <- intersect(possible_year, colnames(museum))[1]
mus_col  <- intersect(possible_mus,  colnames(museum))[1]
vis_col  <- intersect(possible_vis,  colnames(museum))[1]
if (is.na(year_col) || is.na(mus_col) || is.na(vis_col)) {
stop("Could not detect columns for long format. Please check printed column names and set year_col/mus_col/vis_col manually.")
}
museum_long <- museum %>%
mutate(
Year = as.integer(.data[[year_col]]),
Museum = as.factor(.data[[mus_col]]),
Visitors = as.numeric(.data[[vis_col]])
) %>%
select(Year, Museum, Visitors) %>%
filter(!is.na(Year), !is.na(Visitors))
}
# install.packages(c("tidyr","dplyr","ggplot2","readxl"))
library(tidyr)
library(dplyr)
library(ggplot2)
library(readxl)
# =========================
# Q3.1 The Last of Us (given counts)
# =========================
last_of_us <- tribble(
~Location,            ~Gender,  ~Outcome,   ~Count,
"Safe Zone",          "Male",   "Zombie",   118,
"Safe Zone",          "Male",   "Survived", 62,
"Safe Zone",          "Female", "Zombie",   4,
"Safe Zone",          "Female", "Survived", 141,
"Contaminated City",  "Male",   "Zombie",   154,
"Contaminated City",  "Male",   "Survived", 25,
"Contaminated City",  "Female", "Zombie",   13,
"Contaminated City",  "Female", "Survived", 93,
"Rural Area",         "Male",   "Zombie",   422,
"Rural Area",         "Male",   "Survived", 88,
"Rural Area",         "Female", "Zombie",   106,
"Rural Area",         "Female", "Survived", 90,
"Isolated Island",    "Male",   "Zombie",   670,
"Isolated Island",    "Male",   "Survived", 192,
"Isolated Island",    "Female", "Zombie",   3,
"Isolated Island",    "Female", "Survived", 20
)
# Add totals + survival rate
last_of_us2 <- last_of_us %>%
group_by(Location, Gender) %>%
mutate(Total = sum(Count)) %>%
ungroup() %>%
mutate(Prop = Count / Total)
# Plot A: Outcome proportions (best for "survival chances")
ggplot(last_of_us2, aes(x = Location, y = Prop, fill = Outcome)) +
geom_col(position = "fill") +
facet_wrap(~Gender) +
labs(title = "Outcome Proportions by Location (Faceted by Gender)",
x = "Location", y = "Proportion") +
theme_minimal(base_size = 13)
# Plot B: Raw counts (common outcomes, absolute burden)
ggplot(last_of_us, aes(x = Location, y = Count, fill = Outcome)) +
geom_col(position = "stack") +
facet_wrap(~Gender) +
labs(title = "Outcome Counts by Location (Faceted by Gender)",
x = "Location", y = "Count") +
theme_minimal(base_size = 13)
# =========================
# Q3.2 Glass Glimpse (Sheet 3): RI vs Glass Type
# =========================
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
glass <- read_excel(xlsx_path, sheet = "Glass Glimpse")
glass <- as.data.frame(glass)
# Make flexible column selection (handles slight name differences)
colnames(glass) <- trimws(colnames(glass))
type_col <- grep("^Type$|Glass.*Type|glass.*type", colnames(glass), ignore.case = TRUE, value = TRUE)[1]
ri_col   <- grep("^RI$|Refractive.*Index|refractive.*index", colnames(glass), ignore.case = TRUE, value = TRUE)[1]
glass2 <- glass %>%
select(Type = all_of(type_col), RI = all_of(ri_col)) %>%
mutate(Type = as.factor(Type), RI = as.numeric(RI)) %>%
filter(!is.na(Type), !is.na(RI))
# Plot A: Boxplot + jitter (distribution per type)
ggplot(glass2, aes(x = Type, y = RI)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = 0.15, alpha = 0.6, size = 1.8) +
labs(title = "RI by Glass Type (Boxplot + Points)",
x = "Glass Type", y = "Refractive Index (RI)") +
theme_minimal(base_size = 13)
# Plot B: Violin + points (shape, multimodality)
ggplot(glass2, aes(x = Type, y = RI)) +
geom_violin(trim = FALSE) +
geom_jitter(width = 0.15, alpha = 0.5, size = 1.6) +
labs(title = "RI by Glass Type (Violin + Points)",
x = "Glass Type", y = "Refractive Index (RI)") +
theme_minimal(base_size = 13)
# =========================
# Q3.3 Night at the Museum
# =========================
library(readxl)
library(tidyr)
library(dplyr)
library(ggplot2)
museum <- read_excel(xlsx_path, sheet = "Museum Visitor")
museum <- as.data.frame(museum)
colnames(museum) <- trimws(colnames(museum))
# Convert Month to Date
museum$Month <- as.Date(paste0("01 ", museum$Month), format = "%d %b %Y")
# Convert from wide to long
museum_long <- museum %>%
pivot_longer(
cols = -Month,
names_to = "Museum",
values_to = "Visitors"
) %>%
mutate(
Visitors = as.numeric(Visitors),
Museum = as.factor(Museum)
) %>%
filter(!is.na(Visitors))
# ---- Plot 1: Overall trends ----
ggplot(museum_long, aes(x = Month, y = Visitors, color = Museum)) +
geom_line(linewidth = 1) +
labs(
title = "Museum Visitors Over Time",
x = "Time",
y = "Visitor Count"
) +
theme_minimal(base_size = 13)
# ---- Plot 2: Faceted trends ----
ggplot(museum_long, aes(x = Month, y = Visitors)) +
geom_line(linewidth = 1) +
facet_wrap(~Museum, scales = "free_y") +
labs(
title = "Museum Visitors Over Time (Faceted by Museum)",
x = "Time",
y = "Visitor Count"
) +
theme_minimal(base_size = 13)
knitr::opts_chunk$set(echo = TRUE)
# ============================
# Q4: Fast and Furious - Correlation Heatmaps
# ============================
# install.packages(c("readxl", "dplyr", "ggplot2", "reshape2"))
library(readxl)
library(dplyr)
library(ggplot2)
library(reshape2)
# ---- Load data ----
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
data <- read_excel(xlsx_path, sheet = "Fast and Furious")
data <- as.data.frame(data)
# ---- Convert to numeric where possible ----
data_num <- data %>%
mutate(across(everything(), ~ suppressWarnings(as.numeric(.))))
# ---- Remove columns with all NA ----
data_num <- data_num[, colSums(is.na(data_num)) < nrow(data_num)]
# ---- Handle missing values (median imputation) ----
data_num <- data_num %>%
mutate(across(everything(), ~ ifelse(is.na(.), median(., na.rm = TRUE), .)))
# ---- Correlation matrices ----
cor_pearson  <- cor(data_num, method = "pearson")
cor_spearman <- cor(data_num, method = "spearman")
cor_kendall  <- cor(data_num, method = "kendall")
# ---- Helper function for heatmap ----
plot_heatmap <- function(cor_mat, title) {
melt(cor_mat) %>%
ggplot(aes(Var1, Var2, fill = value)) +
geom_tile() +
scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0) +
labs(title = title, x = "", y = "", fill = "Correlation") +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
# ---- Plot heatmaps ----
plot_heatmap(cor_pearson,  "Pearson Correlation Heatmap")
plot_heatmap(cor_spearman, "Spearman Correlation Heatmap")
plot_heatmap(cor_kendall,  "Kendall Correlation Heatmap")
```{r setup, include=FALSE}
