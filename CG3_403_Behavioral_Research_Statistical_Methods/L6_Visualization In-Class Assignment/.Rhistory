print(head(data))
print("Summary:")
print(summary(data))
# ---- 2) Misleading visualization: Bar plot of means ----
means <- colMeans(data, na.rm = TRUE)
par(mar = c(5, 5, 4, 2) + 0.1)
barplot(
means,
col = "lightblue",
main = "Bar Plot of Means (Misleading)",
ylab = "Mean Value",
xlab = "Groups"
)
print("Means per group:")
print(means)
# ---- 3) Best visualization: show distributions / raw points ----
# Convert to long format
data_long <- pivot_longer(
data,
cols = everything(),
names_to = "Group",
values_to = "Value"
)
# 3A) Best Plot 1: Jittered points + boxplot
p1 <- ggplot(data_long, aes(x = Group, y = Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = 0.15, alpha = 0.7, size = 2) +
labs(
title = "Best Visualization: Raw Data (Jitter) + Boxplot",
x = "Group",
y = "Values"
) +
theme_minimal(base_size = 13)
print(p1)
# 3B) Best Plot 2: Violin plot + points (distribution-focused)
p2 <- ggplot(data_long, aes(x = Group, y = Value)) +
geom_violin(trim = FALSE) +
geom_jitter(width = 0.15, alpha = 0.6, size = 1.8) +
labs(
title = "Distribution View: Violin Plot + Raw Points",
x = "Group",
y = "Values"
) +
theme_minimal(base_size = 13)
print(p2)
# ============================
# BRSM Visualization Assignment
# Q1: Statistical Deception (Sheet: "Statistical Deception")
# Extended visualization suite
# ============================
# Install packages once (uncomment if needed)
# install.packages(c(
#   "readxl","tidyr","dplyr","ggplot2","scales",
#   "ggdist","ggbeeswarm","waffle","vcd","fmsb","reshape2"
# ))
library(readxl)
library(tidyr)
library(dplyr)
library(ggplot2)
library(scales)
# Optional packages (we'll use if available)
has_ggdist  <- requireNamespace("ggdist", quietly = TRUE)
has_bees    <- requireNamespace("ggbeeswarm", quietly = TRUE)
has_waffle  <- requireNamespace("waffle", quietly = TRUE)
has_vcd     <- requireNamespace("vcd", quietly = TRUE)
has_fmsb    <- requireNamespace("fmsb", quietly = TRUE)
has_reshape <- requireNamespace("reshape2", quietly = TRUE)
# ---- 1) Load data ----
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
data <- read_excel(xlsx_path, sheet = "Statistical Deception")
data <- as.data.frame(data)
# Safety: keep only numeric columns
data <- data[, sapply(data, is.numeric), drop = FALSE]
cat("\nFirst few rows:\n")
print(head(data))
cat("\nSummary:\n")
print(summary(data))
# Long format (Group, Value)
data_long <- pivot_longer(
data,
cols = everything(),
names_to = "Group",
values_to = "Value"
) %>%
filter(!is.na(Value)) %>%
mutate(Group = factor(Group))
# ---- 2) Misleading visualization: Bar plot of means ----
means <- colMeans(data, na.rm = TRUE)
par(mar = c(5, 5, 4, 2) + 0.1)
barplot(
means,
col = "lightblue",
main = "Bar Plot of Means (Potentially Misleading)",
ylab = "Mean Value",
xlab = "Groups"
)
cat("\nMeans per group:\n")
print(means)
# =========================================================
# 3) Distribution-focused plots (recommended)
# =========================================================
# 3A) Boxplot + jitter (your existing "best")
p_box_jitter <- ggplot(data_long, aes(x = Group, y = Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width = 0.15, alpha = 0.7, size = 2) +
labs(
title = "Boxplot + Raw Points (Good baseline)",
x = "Group", y = "Values"
) +
theme_minimal(base_size = 13)
print(p_box_jitter)
# 3B) Violin + points (your existing)
p_violin <- ggplot(data_long, aes(x = Group, y = Value)) +
geom_violin(trim = FALSE) +
geom_jitter(width = 0.15, alpha = 0.6, size = 1.8) +
labs(
title = "Violin Plot + Raw Points (Distribution view)",
x = "Group", y = "Values"
) +
theme_minimal(base_size = 13)
print(p_violin)
# =========================================================
# 4) Histogram(s)
# =========================================================
# 4A) Overall histogram
p_hist_all <- ggplot(data_long, aes(x = Value)) +
geom_histogram(bins = 25, alpha = 0.8) +
labs(title = "Histogram (All Groups Combined)", x = "Value", y = "Count") +
theme_minimal(base_size = 13)
print(p_hist_all)
# 4B) Faceted histogram by group
p_hist_group <- ggplot(data_long, aes(x = Value)) +
geom_histogram(bins = 20, alpha = 0.8) +
facet_wrap(~ Group, scales = "free_y") +
labs(title = "Histograms by Group", x = "Value", y = "Count") +
theme_minimal(base_size = 13)
print(p_hist_group)
# =========================================================
# 5) Line plot (means + SE)
# =========================================================
stats_by_group <- data_long %>%
group_by(Group) %>%
summarise(
n = n(),
mean = mean(Value),
sd = sd(Value),
se = sd / sqrt(n),
.groups = "drop"
)
p_line_mean <- ggplot(stats_by_group, aes(x = Group, y = mean, group = 1)) +
geom_line(linewidth = 1) +
geom_point(size = 2) +
geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.15) +
labs(
title = "Line Plot of Means (with SE error bars)",
x = "Group", y = "Mean Â± SE"
) +
theme_minimal(base_size = 13)
print(p_line_mean)
# =========================================================
# 6) Raincloud / Raindrop plot
# =========================================================
# True raincloud uses ggdist (recommended).
# Fallback uses violin + dotplot (still good).
if (has_ggdist) {
library(ggdist)
p_raincloud <- ggplot(data_long, aes(x = Group, y = Value)) +
ggdist::stat_halfeye(
adjust = 0.8,
width = 0.6,
justification = -0.2,
point_colour = NA,
alpha = 0.7
) +
ggdist::stat_dots(
side = "left",
justification = 1.1,
binwidth = NULL,
dotsize = 0.5,
alpha = 0.7
) +
geom_boxplot(width = 0.12, outlier.shape = NA, alpha = 0.7) +
coord_flip() +
labs(
title = "Raincloud Plot (Half-eye density + dots + box)",
x = "Group", y = "Value"
) +
theme_minimal(base_size = 13)
print(p_raincloud)
} else {
# Fallback "raindrop-like": violin + dotplot + box
p_raindrop_fallback <- ggplot(data_long, aes(x = Group, y = Value)) +
geom_violin(trim = FALSE, alpha = 0.7) +
geom_boxplot(width = 0.12, outlier.shape = NA, alpha = 0.7) +
geom_dotplot(
binaxis = "y",
stackdir = "center",
dotsize = 0.6,
binwidth = (max(data_long$Value) - min(data_long$Value)) / 30,
alpha = 0.6
) +
coord_flip() +
labs(
title = "Raindrop-style (Violin + Dotplot + Box) [ggdist not installed]",
x = "Group", y = "Value"
) +
theme_minimal(base_size = 13)
print(p_raindrop_fallback)
}
```{r}
# install.packages(c("readxl","tidyr","ggplot2","dplyr","ggridges","ggdist","waffle","fmsb","reshape2"))
library(readxl)
library(tidyr)
library(ggplot2)
library(dplyr)
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
data <- as.data.frame(read_excel(xlsx_path, sheet = "Statistical Deception"))
data <- data[, sapply(data, is.numeric), drop = FALSE]
data_long <- pivot_longer(data, cols = everything(), names_to = "Group", values_to = "Value")
# 1) Bar plot of means
means <- colMeans(data, na.rm = TRUE)
barplot(means, col="lightblue", main="Bar Plot of Means (Misleading)", ylab="Mean", xlab="Group")
# 2) Boxplot
ggplot(data_long, aes(Group, Value)) + geom_boxplot() +
labs(title="Boxplot", x="Group", y="Value") + theme_minimal()
# 3) Jitter + boxplot
ggplot(data_long, aes(Group, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width=0.15, alpha=0.7, size=2) +
labs(title="Jitter + Boxplot", x="Group", y="Value") + theme_minimal()
# 4) Histogram (facets)
ggplot(data_long, aes(Value)) +
geom_histogram(bins=15) +
facet_wrap(~Group, scales="free_y") +
labs(title="Histograms by Group", x="Value", y="Count") + theme_minimal()
# 5) Density (facets)
ggplot(data_long, aes(Value)) +
geom_density() +
facet_wrap(~Group, scales="free_y") +
labs(title="Density by Group", x="Value", y="Density") + theme_minimal()
# 6) Line plot (index vs value)
data_long <- data_long %>% group_by(Group) %>% mutate(Index = row_number()) %>% ungroup()
ggplot(data_long, aes(Index, Value, color=Group)) +
geom_line(alpha=0.7) +
facet_wrap(~Group, scales="free_y") +
labs(title="Line Plot (Index vs Value)", x="Row index", y="Value") + theme_minimal()
# 7) Raincloud / raindrop (needs ggdist)
if (!requireNamespace("ggdist", quietly = TRUE)) {
message("Skipping Raincloud: install.packages('ggdist')")
} else {
library(ggdist)
ggplot(data_long, aes(x=Group, y=Value)) +
ggdist::stat_halfeye(adjust=0.6, width=0.6, justification=-0.2, .width=0) +
geom_boxplot(width=0.15, outlier.shape=NA) +
geom_jitter(width=0.12, alpha=0.5, size=1.6) +
coord_flip() +
labs(title="Raincloud (Half-eye + Box + Points)", x="Group", y="Value") +
theme_minimal()
}
# 8) Mosaic plot (needs categorical data; bin values)
data_long$Bin <- cut(data_long$Value, breaks=5)
tab <- table(data_long$Group, data_long$Bin)
mosaicplot(tab, main="Mosaic Plot (Group x Binned Value)", xlab="Group", ylab="Value bins")
# 9) Waffle plot (counts per group; needs waffle)
counts <- table(data_long$Group)
if (!requireNamespace("waffle", quietly = TRUE)) {
message("Skipping Waffle: install.packages('waffle')")
} else {
waffle::waffle(as.list(counts), rows=5, title="Waffle Plot (Counts per Group)")
}
# 10) Pie chart (counts per group)
pie(counts, main="Pie Chart (Counts per Group)")
# 11) Radar chart (mean + sd per group; needs fmsb)
stats <- data_long %>% group_by(Group) %>% summarise(mean=mean(Value), sd=sd(Value), .groups="drop")
rad <- as.data.frame(t(stats[,c("mean","sd")]))
colnames(rad) <- stats$Group
rad <- rbind(apply(rad,1,max), apply(rad,1,min), rad)
if (!requireNamespace("fmsb", quietly = TRUE)) {
message("Skipping Radar: install.packages('fmsb')")
} else {
library(fmsb)
fmsb::radarchart(rad, axistype=1, title="Radar Chart (Mean & SD)")
}
# 12) Heatmap (correlation across x1-x4)
cor_mat <- cor(data, use="complete.obs")
if (!requireNamespace("reshape2", quietly = TRUE)) {
message("Skipping ggplot heatmap: install.packages('reshape2')")
heatmap(cor_mat, main="Heatmap: Correlation (base R)")
} else {
library(reshape2)
cor_long <- reshape2::melt(cor_mat)
ggplot(cor_long, aes(Var1, Var2, fill=value)) +
geom_tile() +
labs(title="Heatmap: Correlation", x="", y="", fill="corr") +
theme_minimal()
}
# 2) Boxplot
ggplot(data_long, aes(Group, Value)) + geom_boxplot() +
labs(title="Boxplot", x="Group", y="Value") + theme_minimal()
# 3) Jitter + boxplot
ggplot(data_long, aes(Group, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width=0.15, alpha=0.7, size=2) +
labs(title="Jitter + Boxplot", x="Group", y="Value") + theme_minimal()
# 4) Histogram (facets)
ggplot(data_long, aes(Value)) +
geom_histogram(bins=15) +
facet_wrap(~Group, scales="free_y") +
labs(title="Histograms by Group", x="Value", y="Count") + theme_minimal()
# 5) Density (facets)
ggplot(data_long, aes(Value)) +
geom_density() +
facet_wrap(~Group, scales="free_y") +
labs(title="Density by Group", x="Value", y="Density") + theme_minimal()
# 6) Line plot (index vs value)
data_long <- data_long %>% group_by(Group) %>% mutate(Index = row_number()) %>% ungroup()
ggplot(data_long, aes(Index, Value, color=Group)) +
geom_line(alpha=0.7) +
facet_wrap(~Group, scales="free_y") +
labs(title="Line Plot (Index vs Value)", x="Row index", y="Value") + theme_minimal()
# 7) Raincloud / raindrop (needs ggdist)
if (!requireNamespace("ggdist", quietly = TRUE)) {
message("Skipping Raincloud: install.packages('ggdist')")
} else {
library(ggdist)
ggplot(data_long, aes(x=Group, y=Value)) +
ggdist::stat_halfeye(adjust=0.6, width=0.6, justification=-0.2, .width=0) +
geom_boxplot(width=0.15, outlier.shape=NA) +
geom_jitter(width=0.12, alpha=0.5, size=1.6) +
coord_flip() +
labs(title="Raincloud (Half-eye + Box + Points)", x="Group", y="Value") +
theme_minimal()
}
# 8) Mosaic plot (needs categorical data; bin values)
data_long$Bin <- cut(data_long$Value, breaks=5)
tab <- table(data_long$Group, data_long$Bin)
mosaicplot(tab, main="Mosaic Plot (Group x Binned Value)", xlab="Group", ylab="Value bins")
# 9) Waffle plot (counts per group; needs waffle)
counts <- table(data_long$Group)
if (!requireNamespace("waffle", quietly = TRUE)) {
message("Skipping Waffle: install.packages('waffle')")
} else {
waffle::waffle(as.list(counts), rows=5, title="Waffle Plot (Counts per Group)")
}
# 10) Pie chart (counts per group)
pie(counts, main="Pie Chart (Counts per Group)")
# 11) Radar chart (mean + sd per group; needs fmsb)
stats <- data_long %>% group_by(Group) %>% summarise(mean=mean(Value), sd=sd(Value), .groups="drop")
rad <- as.data.frame(t(stats[,c("mean","sd")]))
colnames(rad) <- stats$Group
rad <- rbind(apply(rad,1,max), apply(rad,1,min), rad)
if (!requireNamespace("fmsb", quietly = TRUE)) {
message("Skipping Radar: install.packages('fmsb')")
} else {
library(fmsb)
fmsb::radarchart(rad, axistype=1, title="Radar Chart (Mean & SD)")
}
# 12) Heatmap (correlation across x1-x4)
cor_mat <- cor(data, use="complete.obs")
if (!requireNamespace("reshape2", quietly = TRUE)) {
message("Skipping ggplot heatmap: install.packages('reshape2')")
heatmap(cor_mat, main="Heatmap: Correlation (base R)")
} else {
library(reshape2)
cor_long <- reshape2::melt(cor_mat)
ggplot(cor_long, aes(Var1, Var2, fill=value)) +
geom_tile() +
labs(title="Heatmap: Correlation", x="", y="", fill="corr") +
theme_minimal()
}
# install.packages(c("readxl","tidyr","ggplot2","dplyr","ggridges","ggdist","waffle","fmsb","reshape2"))
library(readxl)
library(tidyr)
library(ggplot2)
library(dplyr)
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
data <- as.data.frame(read_excel(xlsx_path, sheet = "Statistical Deception"))
data <- data[, sapply(data, is.numeric), drop = FALSE]
data_long <- pivot_longer(data, cols = everything(), names_to = "Group", values_to = "Value")
# 1) Bar plot of means
means <- colMeans(data, na.rm = TRUE)
barplot(means, col="lightblue", main="Bar Plot of Means (Misleading)", ylab="Mean", xlab="Group")
knitr::opts_chunk$set(echo = TRUE)
# install.packages(c("readxl","tidyr","ggplot2","dplyr","ggridges","ggdist","waffle","fmsb","reshape2"))
library(readxl)
library(tidyr)
library(ggplot2)
library(dplyr)
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
data <- as.data.frame(read_excel(xlsx_path, sheet = "Statistical Deception"))
data <- data[, sapply(data, is.numeric), drop = FALSE]
data_long <- pivot_longer(data, cols = everything(), names_to = "Group", values_to = "Value")
# 1) Bar plot of means
means <- colMeans(data, na.rm = TRUE)
barplot(means, col="lightblue", main="Bar Plot of Means (Misleading)", ylab="Mean", xlab="Group")
# 2) Boxplot
ggplot(data_long, aes(Group, Value)) + geom_boxplot() +
labs(title="Boxplot", x="Group", y="Value") + theme_minimal()
# 3) Jitter + boxplot
ggplot(data_long, aes(Group, Value)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter(width=0.15, alpha=0.7, size=2) +
labs(title="Jitter + Boxplot", x="Group", y="Value") + theme_minimal()
# 4) Histogram (facets)
ggplot(data_long, aes(Value)) +
geom_histogram(bins=15) +
facet_wrap(~Group, scales="free_y") +
labs(title="Histograms by Group", x="Value", y="Count") + theme_minimal()
# 5) Density (facets)
ggplot(data_long, aes(Value)) +
geom_density() +
facet_wrap(~Group, scales="free_y") +
labs(title="Density by Group", x="Value", y="Density") + theme_minimal()
# 6) Line plot (index vs value)
data_long <- data_long %>% group_by(Group) %>% mutate(Index = row_number()) %>% ungroup()
ggplot(data_long, aes(Index, Value, color=Group)) +
geom_line(alpha=0.7) +
facet_wrap(~Group, scales="free_y") +
labs(title="Line Plot (Index vs Value)", x="Row index", y="Value") + theme_minimal()
# 7) Raincloud / raindrop (needs ggdist)
if (!requireNamespace("ggdist", quietly = TRUE)) {
message("Skipping Raincloud: install.packages('ggdist')")
} else {
library(ggdist)
ggplot(data_long, aes(x=Group, y=Value)) +
ggdist::stat_halfeye(adjust=0.6, width=0.6, justification=-0.2, .width=0) +
geom_boxplot(width=0.15, outlier.shape=NA) +
geom_jitter(width=0.12, alpha=0.5, size=1.6) +
coord_flip() +
labs(title="Raincloud (Half-eye + Box + Points)", x="Group", y="Value") +
theme_minimal()
}
# 8) Mosaic plot (needs categorical data; bin values)
data_long$Bin <- cut(data_long$Value, breaks=5)
tab <- table(data_long$Group, data_long$Bin)
mosaicplot(tab, main="Mosaic Plot (Group x Binned Value)", xlab="Group", ylab="Value bins")
# 9) Waffle plot (counts per group; needs waffle)
counts <- table(data_long$Group)
if (!requireNamespace("waffle", quietly = TRUE)) {
message("Skipping Waffle: install.packages('waffle')")
} else {
waffle::waffle(as.list(counts), rows=5, title="Waffle Plot (Counts per Group)")
}
# 10) Pie chart (counts per group)
pie(counts, main="Pie Chart (Counts per Group)")
# 11) Radar chart (mean + sd per group; needs fmsb)
stats <- data_long %>% group_by(Group) %>% summarise(mean=mean(Value), sd=sd(Value), .groups="drop")
rad <- as.data.frame(t(stats[,c("mean","sd")]))
colnames(rad) <- stats$Group
rad <- rbind(apply(rad,1,max), apply(rad,1,min), rad)
if (!requireNamespace("fmsb", quietly = TRUE)) {
message("Skipping Radar: install.packages('fmsb')")
} else {
library(fmsb)
fmsb::radarchart(rad, axistype=1, title="Radar Chart (Mean & SD)")
}
# 12) Heatmap (correlation across x1-x4)
cor_mat <- cor(data, use="complete.obs")
if (!requireNamespace("reshape2", quietly = TRUE)) {
message("Skipping ggplot heatmap: install.packages('reshape2')")
heatmap(cor_mat, main="Heatmap: Correlation (base R)")
} else {
library(reshape2)
cor_long <- reshape2::melt(cor_mat)
ggplot(cor_long, aes(Var1, Var2, fill=value)) +
geom_tile() +
labs(title="Heatmap: Correlation", x="", y="", fill="corr") +
theme_minimal()
}
knitr::opts_chunk$set(echo = TRUE)
```{r}
# install.packages(c("readxl","tidyr","ggplot2","dplyr"))
library(readxl)
library(tidyr)
library(ggplot2)
library(dplyr)
xlsx_path <- "BRSM_Visualisation_Assignment.xlsx"
# ---- Load Sheet 2 ----
df <- read_excel(xlsx_path, sheet = "Movement Personality Results")
df <- as.data.frame(df)
# Keep only numeric columns (importance values)
num_cols <- names(df)[sapply(df, is.numeric)]
df_num <- df[, num_cols, drop = FALSE]
# Long format: Joint x Trait -> Importance
# If your sheet already has columns like: Joint, Trait, Importance, then skip this and use them directly.
long <- pivot_longer(
df_num,
cols = everything(),
names_to = "Trait",
values_to = "Importance"
)
# Add joint index (assumes each row corresponds to one joint: 12 rows)
# If you have an actual joint-name column in df (e.g., "Joint"), replace Joint = ... accordingly.
long <- long %>%
group_by(Trait) %>%
mutate(Joint = rep(paste0("J", seq_len(nrow(df_num))), times = 1)) %>%
ungroup()
# ---- 1) Heatmap (recommended) ----
p_heat <- ggplot(long, aes(x = Trait, y = Joint, fill = Importance)) +
geom_tile() +
labs(title = "Heatmap: Joint Importance per Personality Trait",
x = "Personality Trait", y = "Joint") +
theme_minimal(base_size = 13)
print(p_heat)
# ---- 2) Grouped bar plot (alternative) ----
p_bar <- ggplot(long, aes(x = Joint, y = Importance, fill = Trait)) +
geom_col(position = "dodge") +
labs(title = "Grouped Bar Plot: Joint Importance per Trait",
x = "Joint", y = "Importance") +
theme_minimal(base_size = 13)
print(p_bar)
knitr::opts_chunk$set(echo = TRUE)
